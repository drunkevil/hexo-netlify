{"compress":true,"commitItems":[["2cda21d0-6f82-4869-8fa0-a8f12e801248",1537751714913,"title: Hexo静态博客添加站内搜索--Swiftype\ndate: 2015-04-08 10:50:27\ncategories: 学习笔记\n---\n\n大多数像Hexo一样的静态博客系统，很多功能都需要借助第三方的服务才能实现，比如评论系统、分享功能和站内搜索等。这对于一些对自己的数据比较敏感的人来说很难接受。我的看法是，只要第三方应用做得好并且可靠，就会去使用。WordPress中很多做得很好的第三方插件使用者也很多。所以，对于第三方的东西，不能一棒子打死。\n\n<!--more-->\n\n为静态博客添加第三方应用的方式大同小异，都是将第三方提供的JS代码嵌入到网站模板的合适位置，调用其服务器端代码。\n\n作为个人博客的基础功能之一，站内搜索必不可少，提供这一功能的第三方公司也为数不少。其中，百度站内搜索和Google CSE类似，都是依托自身强大的搜索技术提供服务；而微搜索和Swiftype则是专门做站内搜索功能的初创企业的代表，后者更是其中的佼佼者，2012年毕业于大名鼎鼎的Y Combinator，总部位于旧金山。\n\nGoogle无疑是搜索领域的老大，但是Swiftype也有自己面向网站和app侧的优势，它的平台可定制性很强，Swiftype还开放了API接口，供网站深度访问其搜索功能，可以满足不同网站的个性化需求，而Google的Custome Search Engine，定制性不够强。关键的是，由于被墙的原因，Google CSE在国内也基本上很难使用。\n\nSwiftype可以为网站及移动app提供内置搜索引掣服务。其部署十分简单，只须输入URL地址平台即可执行对用户网站的抓取，插入JS代码嵌入网站就即完成搜索引擎的创建。Swiftype还提供了分析服务，供网站检索分析用户的搜索行为和使用偏好。Swiftype还支持对搜索结果排序进行定制。\n\n我的博客采用[Hexo](http://drunkevil.com/2015/02/05/hexo-gitcafe/)搭建，主题在[jacman](https://github.com/wuchong/jacman)的基础上修改而来。前两天放假，增加了基于Swiftype的站内搜索功能，下面是实现步骤：\n\n----------\n\n#### 1、\n到swiftype的网站[https://swiftype.com](https://swiftype.com)注册账号，输入自己网站的URL地址，根据指引建立自己站点对应的Engine；\n\n![](http://ww4.sinaimg.cn/mw690/aeba7ac3gw1eqx9ly7v66j20g30b7gmy.jpg)\n\n#### 2、\n\n切换到Install面板，根据需要配置自己站点的Engine，我的配置如下；\n\n![](http://ww3.sinaimg.cn/mw690/aeba7ac3gw1eqx9lxo32ej20fu0rzq5z.jpg)\n\n#### 3、\n\n点击左侧的“SWIFTYPE INSTALL CODE”获取根据配置得到的JS代码；\n\n![](http://ww1.sinaimg.cn/mw690/aeba7ac3gw1eqx9lx8p5zj20q70exwgy.jpg)\n\n将其添加到jacman\\layout\\ _partial目录下的footer.ejs文件;\n\n#### 4、\n\n在jacman主题下的_config.yml文件末尾添加如下代码：\n\n\n\n>     swift_search:\n  \t\tenable: true\n\n#### 5、\n在hexo的source目录下建立一个search文件夹，并在其中新建一个index.md文件，其内容为：\n\n\n\n>     layout: search\n\ttitle: search\n\t---\n\n#### 6、\n\n找到jacman\\layout\\ _partial目录下的header.ejs文件，在其中添加如下代码：\n\n\n\n>     <% if (theme.swift_search.enable){ %>\n\t\t<form class=\"search\" action=\"<%- config.root %>search/index.html\" method=\"get\" accept-charset=\"utf-8\">\n\t\t<input type=\"text\" id=\"st-search-inpu\" maxlength=\"20\" placeholder=\"搜索\" />\n\t\t</form>\n\t<% }\n\n#### 7、\n\n将jacman\\layout\\ _partial目录下的search.ejs中的内容替换为如下代码（主要用来控制结果的显示样式，可根据个人爱好修改）：\n\n\n\n> \t<% if(theme.swift_search.enable) { %>\n\t\t<div  id=\"container\" class=\"page\">\n  \t\t<div id=\"st-results-container\" style=\"width:70%; margin:1.5em auto\">正在加载搜索结果，请稍等。</div>\n  \t<style>\n\t.st-result-text {\n \t\tbackground: #fafafa;\n  \t\tdisplay: block;\n  \t\tborder-left: 0.5em solid #ccc;\n  \t\t-webkit-transition: border-left 0.45s;\n  \t\t-moz-transition: border-left 0.45s;\n  \t\t-o-transition: border-left 0.45s;\n  \t\t-ms-transition: border-left 0.45s;\n  \t\ttransition: border-left 0.45s;\n  \t\tpadding: 0.5em;\n\t\t}\n\t@media only screen and (min-width: 768px) {\n  \t.st-result-text {\n    \tpadding: 1em;\n  \t\t}\n\t}\n\t.st-result-text:hover {\n \t \tborder-left: 0.5em solid #ea6753;\n\t\t}\n\t.st-result-text h3 a{\n  \t\tcolor: #2ca6cb;\n  \t\tline-height: 1.5;\n  \t\tfont-size: 22px;\n\t\t}\n\t.st-snippet em {\n  \t\tfont-weight: bold;\n  \t\tcolor: #ea6753;\n\t\t}\n\t</style>\n\t<% } %>\n\n#### 8、\n\n至此，配置完成，`hexo d -g`重新部署一下即可出现站内搜索功能。搜索框的样式可根据个人爱好在CSS文件中修改。\n\n麻雀虽小，五脏俱全，博客的基础功能基本上都已实现。\n\n\n----------\n\n####参考链接：\n\n[1]  [静态博客如何实现站内搜索](http://blog.moyizhou.cn/web/search-engine-for-static-pages/)；\n\n[2]  文中代码主要参考的[这里](http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html)，向博主表示感谢。\n",[[1537751713587,["zwyan@DESKTOP-O05NJNV",[[1,75,"\n"]],[74,74],[75,75]]],[1537751723326,["zwyan@DESKTOP-O05NJNV",[[1,161,"\n"]],[161,161],[162,162]]],[1537751723532,["zwyan@DESKTOP-O05NJNV",[[1,162,"\n"]],[162,162],[163,163]]],[1537751726176,["zwyan@DESKTOP-O05NJNV",[[-1,241,"<!--more-->"]],[241,252],[241,241]]],[1537751727298,["zwyan@DESKTOP-O05NJNV",[[1,163,"\n"]],[162,162],[163,163]]],[1537751727469,["zwyan@DESKTOP-O05NJNV",[[1,164,"\n"]],[163,163],[164,164]]],[1537751728432,["zwyan@DESKTOP-O05NJNV",[[1,163,"<!--more-->"]],[163,163],[174,174]]]],null,"zwyan@DESKTOP-O05NJNV"]]}